<h1>Upload do Documento Assinado</h1>

<%= form_with model: @resposta, url: confirmar_upload_fornecedores_resposta_de_cotacao_path(@resposta), local: true, method: :post, multipart: true, data: { controller: "upload-modal" } do |f| %>
  <div data-upload-modal-target="fileFieldsContainer">
    <div class="mt-4 file-field">
      <label class="file-label">Selecione a cotação assinada ou a primeira página do documento</label>
      <%= f.file_field :documentos_assinados, name: "resposta_de_cotacao[documentos_assinados][]", class: "border rounded px-2 py-1 file-input", data: { action: "change->upload-modal#handleFileSelection" } %>
      <span class="file-name hidden"></span>
    </div>
  </div>

  <div class="mt-4">
    <button type="button" data-upload-modal-target="addFileButton" class="bg-gray-500 text-white px-4 py-2 rounded hidden" data-action="click->upload-modal#addFileField">
      Selecionar outro arquivo
    </button>
  </div>

  <div class="mt-4">
    <button type="button" data-upload-modal-target="resetButton" class="bg-red-500 text-white px-4 py-2 rounded hidden" data-action="click->upload-modal#resetFiles">
      Recomeçar busca
    </button>
  </div>

  <div class="mt-4">
    <button type="submit" data-action="click->upload-modal#openModal" class="bg-blue-500 text-white px-4 py-2 rounded">
      Enviar Documento
    </button>
  </div>

  <!-- Modal de confirmação -->
  <div data-upload-modal-target="modal" class="hidden fixed inset-0 flex items-center justify-center bg-gray-800 bg-opacity-50">
    <div class="bg-white p-4 rounded w-1/3">
      <h2 class="text-lg font-bold mb-2">Confirmação</h2>
      <p>Confirma o envio da cotação para o cliente?</p>
      <div class="flex justify-end space-x-4 mt-4">
        <button data-action="click->upload-modal#confirm" class="bg-green-500 text-white px-4 py-2 rounded">Sim</button>
        <button data-action="click->upload-modal#cancel" class="bg-red-500 text-white px-4 py-2 rounded">Não, revisar arquivos</button>
      </div>
    </div>
  </div>
<% end %>
